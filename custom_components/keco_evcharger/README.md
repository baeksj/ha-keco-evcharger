# KECO EV Charger (Home Assistant 커스텀 컴포넌트)

한국환경공단(KECO) 전기차 충전소 OpenAPI 연동 컴포넌트입니다.

## 동작 방식 (현재)
- **항목 추가(통합 추가)** 시:
  - 첫 등록이면 서비스키 입력
  - 이미 등록된 항목이 있으면 저장된 서비스키 재사용
  - 상단 도시 선택(zcode) + 하단 키워드 입력으로 조회
  - 조회 결과 선택 화면에서 `Reset`으로 검색 결과 초기화 후 재검색
  - 선택 도시에서 다중 페이지(최대 12페이지) 조회 후 매칭
  - 충전소 검색 → 선택 후 해당 충전소를 **새 항목(새 기기)** 으로 등록
- 각 항목의 톱니바퀴(옵션)에서는:
  - 충전소 추가/제거 없이
  - **충전기 ID(chgerId) 선택** 제공
  - **연속 API 실패 허용 횟수** 설정 제공 (기본 3회, 1~20)

## 설치
- 이 폴더(`custom_components/keco_evcharger`)를 Home Assistant의 `/config/custom_components/` 아래에 복사하세요.
- 또는 저장소 루트의 README에 있는 HACS 설치 절차를 따르세요.

## 초기 설정
1. Home Assistant → 설정 → 기기 및 서비스 → 통합 추가 → **KECO EV Charger**
2. 서비스키 입력(최초 1회)
   - **Decoding(일반 인증키) 권장**
   - 발급: https://www.data.go.kr → `한국환경공단_전기자동차 충전소 정보` → 활용신청
3. 충전소 검색 후 선택

## 엔티티 정책
- 기본 활성: 상태, 상태 갱신 시각, 현재 충전 시작 시각
- 기본 비활성: 상태 코드, 직전 충전 시작/종료 시각, 출력(kW)
  - 필요 시 엔티티 레지스트리에서 활성화

## 데이터 갱신 주기
- **5분 고정** (300초)

## API 실패 허용 횟수 옵션
- 위치: 통합 옵션(구성)
- 기본값: 3회
- 범위: 1~20
- 설정값 미만 실패: 직전 상태 유지
- 설정값 도달: 엔티티 `unavailable` 처리
